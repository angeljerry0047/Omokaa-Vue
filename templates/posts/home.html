{% extends 'accounts/base.html' %}
{% load static %}
{% load customtags %}
{% block title %}Omokaa | #ShareYourHustle{% endblock %}
{% block content %}

<style>
    .body-sm {
        padding-top: 10px;
        margin: 0;
    }

    .comment {
        border-radius: 10px;
        margin-top: 10px;
        background-color: white;
        padding: 10px 20px;
        width: 100%;
        border: 1px solid #dfcfcf;
    }

    .share-post {
        position:relative;
        padding: 10px 20px;
        margin-bottom: 10px;
        box-shadow: 0 8px 6px -6px #666666;
        -webkit-box-shadow: 0 8px 6px -6px #666666;
        -moz-box-shadow: 0 8px 6px -6px #666666;
    }

    .share-post h1 {
        color: #0088ff;
        font-size: 20px;
        font-weight: 500;
        background-color: white;
        text-align: center;
        padding: 5px 5px 0;
        margin: 0 auto 5px;
    }

    .closeBtn {
        height: 40px;
        width: 40px;
        background-color: #f0f2f5;
        border-radius: 50%;
        padding-right: 7px;
    }

    .closeBtn:hover {
        background-color: #666666;
    }

    .shareBtn {
        margin: 8px auto;
        cursor: pointer;
    }

    .shareBtn-sm {
        cursor: pointer;
    }

    .selectedType,.shareBtn-sm:hover{
        background:#e9fbff;
        border-radius:10px;
        color:white;
    }

    .share-post select {
        margin: 8px auto;
    }

    .share-post textarea {
        margin: 8px auto 10px;
        padding: 14px;
        background-color: #f0f2f5;
    }

    #id_location {
        border-bottom: 1px solid gray;
        border-radius: 0px;
        border-top: none;
        border-left: none;
        border-right: none;
    }

    .share-button button {
        width: 100%;
        border-radius: 20px;
        background-color: #0088ff;
        margin-bottom: 10px;
    }



    @media (max-width: 555px){
        .menu-md{
            display: none;
        }
    }

    @media (min-width: 556px) {
        #menu-xs{
            display: none;
        }

        .menu-md td{
            padding: 10px;
        }
    }

    .profile_img img {
        height: 40px;
        width: 40px;
        border: 2px solid white;
        border-radius: 50%;
        background-color: white;
    }

    /* This is copied from https://github.com/blueimp/jQuery-File-Upload/blob/master/css/jquery.fileupload.css */
    .fileinput-button {
        position: relative;
        overflow: hidden;
    }

    .fileinput-button input {
        position: absolute;
        top: 0;
        right: 0;
        margin: 0;
        opacity: 0;
        -ms-filter: "alpha(opacity=0)";
        font-size: 200px;
        direction: ltr;
        cursor: pointer;
    }

    .thumb {
        height: 80px;
        width: 100px;
        border: 1px solid #000;
    }


    .fileThumbnail{
        height: 25px;
        width:30px;
        top:-1px;
        left:-1px;
    }

    ul.thumb-Images li {
        width: 120px;
        float: left;
        display: inline-block;
        vertical-align: top;
        height: 120px;
    }

    .img-wrap {
        position: relative;
        display: inline-block;
        font-size: 0;
    }

    .img-wrap .close {
        position: absolute;
        top: 2px;
        right: 2px;
        z-index: 100;
        background-color: #d0e5f5;
        padding: 5px 2px 2px;
        color: #000;
        font-weight: bolder;
        cursor: pointer;
        opacity: 0.5;
        font-size: 23px;
        line-height: 10px;
        border-radius: 50%;
    }

    .img-wrap:hover .close {
        opacity: 1;
        background-color: #ff0000;
    }

    .FileNameCaptionStyle {
        font-size: 12px;
    }

    .no-interests {
        text-align: center;
        margin: 40px auto;
    }

    .two-rows{

    }

    @media only screen and (max-width: 768px) {
        .colsm select {
            margin: auto 2px;
        }

        .two-rows{
            flex: 0 50%;
            min-width: auto;
        }

    }

    @media only screen and (min-width: 768px) {
        .post-form {
            background-color: white;
            border-radius: 10px;
        }

        .share-post {
            background-color: white;
            border-radius: 5px;
        }

        .no-interests {
            margin: 10px auto;
            font-size: 20px;
            background-color: white;
            padding: 50px 20px;
            border-radius: 5px;
        }

        .promote button {
            width: 80%;
            margin: 20px auto -20px;
        }

        .signBtn a{
            color: white;
        }

        .signBtn a:hover{
            text-decoration: none;
        }

    }

    @media only screen and (min-width: 1200px) {
        .footer-menu {
            color: #666666;
            text-align: center;
        }

        .footer-menu a {
            color: #666666 !important;
            text-decoration: none;
        }
    }

</style>

<div class="container-fluid body-sm">
    <h1 style="display: none">#ShareYourHustle without a hassle. Connecting millions of hustlers around the world,
        Omokaa is a secure, first-rate ecommerce platform to sell and buy goods and services freely.</h1>
    <div id="reportAlert" class="alert alert-success alert-dismissible fade show" role="alert" style="display:none">
        <strong>Thanks </strong> Your response has been recorded.
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="row">
        <div class="col-lg-2 d-none d-lg-block">
        {% if request.user.is_authenticated %}
            {% include 'snippets/account_link.html' %}
            {% if not request.user.bio %}
            <div class="add-bio" id="bioSection">
                <form onsubmit="submitBio(event)" biourl="{% url 'add_bio' %}">
                <div class="row">
                    <div class="col">
                            <textarea id="bioinput" rows="1" class="form-control textarea addBio" placeholder="Add Bio" required></textarea>
                    </div>
                    <div class="col-1 bi-pencil-col">
                        <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-pencil-fill" fill="#666666" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                        </svg>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary pull-right bio-btn" style="display: none;">Add Bio</button>
                </form>
            </div>
            <div style="display:none;margin-top:10px;" id="bioAlert"
                 class="alert alert-success alert-dismissible fade show" role="alert">
                Your bio has been submitted.
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            {% endif %}
            {% else %}
            <div class="row mt-4">
                <div class="col-auto profile-pic">
                    <img src="{{defaultImage.profile_image.url}}">
                </div>
                <div class="col">
                    <p style="font-size: 14px"><b>Anonymous</b> @guest</p>
                </div>
            </div>
            <a href="{% url 'registration_view' %}"><button class="btn btn-primary mt-4 signBtn" style="width: 100%">Sign in</button></a>
            <a href="{% url 'registration_view' %}"><button class="btn btn-secondary mt-4 signBtn" style="width: 100%">Sign up</button></a>
        {% endif %}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 post-detail">
            <div class="share-post">
                <div class="row" id="shareH1">
                    <div class="col">
                        <h1 class="">#ShareYourHustle</h1>              
                    </div>
                </div>
                <div class="row" id="shareHeader" style="display: none; margin-bottom: 5px;">
                    <div class="col-2 profile_img ml-1">
                        {% if request.user.is_authenticated %}
                        {% if request.user.profile_pic %}
                        <img src="{{request.user.profile_pic.url}}">
                        {% else %}
                        <img src="{{defaultImage.profile_image.url}}">
                        {% endif %}
                        {% else %}
                        <img src="{{defaultImage.profile_image.url}}">
                        {% endif %}
                    </div>
                    <div class="col-8"></div>
                    <div class="col-right pull-right closeBtn" id="closebutton"  align="right"  disabled="disabled">
                        <button  type="button" class="close" aria-label="Close" style="font-size: 44px;
                            font-weight: 100; margin-top: -1px; color: #666666">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
                <hr class="mt-1">
                <table width="100%" id="menu-table">
                    <tr style="display:flex;justify-content:space-between;flex-wrap:wrap;">
                        {% for type in types %}
                            <td align="center" class="shareBtn-sm two-rows" typeid={{type.id}} style="min-width:100px;margin:10px 0; padding: 5px 0; color: #0088ff" {% if request.user.is_authenticated %} onclick="selectType(event)" {% else %} onclick="openUnAuthModule(event)"{% endif %}>
                               {% if type|lower == 'buy' %}
                               {% include 'svgicons/buy.html' %}
                               {% elif type|lower == 'sell' %}
                               {% include 'svgicons/sell.html' %}
                               {% elif type|lower == 'hire' %}
                               {% include 'svgicons/hire.html' %}
                               {% elif type|lower == 'work' %}
                               {% include 'svgicons/work.html' %}
                               {% endif %}
                                {{type}}
                            </td>
                        {% endfor %}
                    </tr>
                </table>
                <div class="row">
                    <!-- spinner start -->
                        <div id="postFormSpinner" style="position: absolute;width: 95%;z-index:100;height:75%;background:rgba(67, 173, 215, 0.21) none repeat scroll 0% 0%;border-radius:2%;display:none">
                     <div class="spinner-border"  role="status"
                     style="margin-left:50%;margin-top:20%;"></div>
                     </div>
                     <!-- spinner end -->
                    <div class="col-3 menu-md" id="menu-md" style="display: none">
                        <table>
                            {% for type in types %}
                                <tr>
                                    <td class="shareBtn-sm" typeid={{type.id}} id="{{type.id}}formtype" onclick="selectType(event)" style="margin: 5px 0; color: #0088ff">
                                    {% if type|lower == 'buy' %}
                               {% include 'svgicons/buy.html' %}
                               {% elif type|lower == 'sell' %}
                               {% include 'svgicons/sell.html' %}
                               {% elif type|lower == 'hire' %}
                               {% include 'svgicons/hire.html' %}
                               {% elif type|lower == 'work' %}
                               {% include 'svgicons/work.html' %}
                               {% endif %}
                                        {{type}}
                                </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                    <div class="col">
                        <!-- Form start -->
                <div id="shareDetails" style="display: none;">
                    <form method="POST" enctype="multipart/form-data" id="postForm"
                  data-category-url="{% url 'ajax_load_category' %}" formURL="{% url 'create_ordinary_post' %}"
                  promotionalFormURL="{% url 'create_promotional_post' %}" novalidate onsubmit="">
                  {% csrf_token %}
                    <div class="row">   
                        <div class="col-sm-6" style="display:none">               
                             {{post_form.type}}
                        </div>
                        <div class="col-sm-6">
                             {{post_form.category}}
                        </div>
                        <div class="col-sm-6">
                            {{post_form.sub_category}}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            {{post_form.detail}}
                        </div>
                    </div>
                    <div class="row post-images">
                        <div class="col-2">
                            <span class="fileinput-button">
                                <span>
                                    <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-images"
                                         fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                      <path fill-rule="evenodd"
                                            d="M12.002 4h-10a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1zm-10-1a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-10z"/>
                                      <path d="M10.648 8.646a.5.5 0 0 1 .577-.093l1.777 1.947V14h-12v-1l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z"/>
                                      <path fill-rule="evenodd"
                                            d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM4 2h10a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1v1a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2h1a1 1 0 0 1 1-1z"/>
                                    </svg>
                                </span>
                                 <input class="fileThumbnail" type="file" name="files[]" id="files" multiple
                                        accept="image/jpeg, image/png, image/gif,"><br/>
                                <input class="fileThumbnail" type="file" name="thumbnail" id="id_thumbnail" multiple
                                       accept="image/jpeg, image/png, image/gif,"><br/>
                            </span>
                        </div>
                        <div class="col-1 mt-1 mr-0" style="float: right">
                            <svg width="1.5em" height="2em" viewBox="0 0 16 16" class="bi bi-geo-alt"
                                 fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                      d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                            </svg>
                        </div>
                        <div class="col ml-0">{{post_form.location}}</div>
                    </div>
                    <div class="row">
                        <output id="Filelist"></output>
                    </div>
                    <div class="row">
                        <div class="content" id="promotePay" style="display: none;width:100%;">
                <div class="row">
                    <div class="col">
                        <form id="promotionalForm">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="package_type"
                                       id="Radios1" value="1000" checked>
                                <label class="form-check-label" for="Radios1">1 month</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="package_type"
                                       id="Radios3" value="3000">
                                <label class="form-check-label" for="Radios3">3 months</label>
                            </div>
                        </form>
                    </div>
                    <div class="col text-center">
                        <h2>Ksh. 1,000</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h3 align="center">Payment Gateway Here</h3>
                    </div>
                </div>
                <div class="row">
                    <div class="col text-right">
                        <button class="btn btn-warning" type="button"
                                onclick="hidePromotional(event)">Cancel
                        </button>
                        <button class="btn btn-primary" id="submit2" type="submit"
                                onclick="submitPromotionalPost(event)">Post
                        </button>
                    </div>
                </div>
            </div>
                    </div>
                    <div class="row" id="postBtn">
                        <div class="col share-button">
                            <button id="submit" class="btn btn-primary" {% if request.user.is_authenticated %}onclick="submitPost(event)"{% else %}onclick="openUnAuthModule(event)"{% endif %}>Post</button>
                        </div>
                    </div>
                    <div id="promote" style="display: none">
                    <div class="row">
                        <div class="col share-button">
                            <button id="promotePost" class="btn btn-primary" onclick="displayPromotion(event)"
                                    type="button">Promote Post
                            </button>
                        </div>
                    </div>
                    <div class="row">
                         <div class="col share-button">
                           <button id="submit1" class="btn btn-primary" type="button" 
                                    onclick="submitPost(event)">Post as ordinary post
                            </button>
                        </div>
                    </div>
                    </div>
                    </form>
                </div>       
                <!-- Form end -->
                    </div>
                </div>
            </div>
            
                <div class="row" id="postDisplay" postURL="{% url 'load_post' %}" style="margin-bottom:50px;">
                    <div class="spinner-border" id="disabledPostButton" role="status"
                         style="margin-left:50%;margin-top:20%;"></div>
                </div>
        </div>

        <div class="col-md-4 d-none d-md-block">
            {% if not request.user.is_authenticated %}
            <div class="content" id="filterSection">
                <h5 align="center">Filter by:</h5>
                <hr>
                <form class="form-filter" id="resultForm" data-category-url="{% url 'ajax_load_category' %}" data-result-url="{% url 'load_results' %}" people-data-url="{% url 'load_people_results' %}" bio-data-url="{% url 'load_bio_results' %}" onsubmit="submitFilter(event)" novalidate>
                    <div class="row mb-3">
                        <div class="col">
                            {{filter_form.type}}
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col">
                            {{filter_form.category}}
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col">
                            {{filter_form.sub_category}}
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col">
                            {{filter_form.location}}
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">Filter</button>
                </form>
            </div>
            {% endif %}
            {% if not nointerest %}
            <div id="selectedInterest" interestUrl="{% url 'load_users_interest' %}">

            </div>

            <div class="content" id="selectInterest" style="display:none">
                <div style="position: relative;">
                    <h4 align="center">Select Interests</h4>
                    <button id="closeBtn" type="button" class="close" data-dismiss="modal" aria-label="Close"
                            style="position:absolute;top:0px;right:0px;font-size:30px;"
                            onclick="closeSelectInterest(event)">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <hr>
                <form id="interestForm" reloadurl="{% url 'post_reload_url' %}">
                    <ul style="list-style:none;margin:2px 0px;" id="interestTag"
                        categoryURL="{% url 'load_categories' %}"
                        subCategoryURL="{% url 'load_sub_categories' %}">
                        {% for types in interest_types %}
                        <li style="margin:2px 0px;margin-left: -40px;">
                            <input type="checkbox" name="types" value={{types.id}} typeid={{types.id}}
                                   onchange="loadCategories(event)" {% if userInterest|isTypeChecked:types.id %} checked
                                   {% endif %}>
                            <label for={{types.name}} class="interestLabel"
                                   style="font-size:16px;">{{types.name}}</label>
                            <div id="{{types.id}}loadCategories">
                                {% if userInterest|isTypeChecked:types.id %}
                                <ul style="list-style:none;margin:2px 0px;">
                                    {% for category in types.category_set.all %}
                                    <li style="font-size: 14px; margin: 2px auto;">
                                        <input type="checkbox" name="categories" value={{category.id}}
                                               categoryid={{category.id}} typeid={{types.id}}
                                               onchange="loadSubCategories(event)"
                                               {% if userInterest|one_more:category.id|isCategoryChecked:types.id %}
                                               checked
                                               {% endif %}>
                                        <label style="font-size: 14px;" class="interestLabel" for={{category.name}}>{{category.name}}</label>
                                        <div id="{{types.id}}{{category.id}}loadSubCategories">
                                            {% if userInterest|one_more:category.id|isCategoryChecked:types.id %}
                                            <ul style="list-style:none;margin:2px 0px;">
                                                {% for subcategory in category.subcategory_set.all %}
                                                <li style="font-size: 12px; margin:2px auto;">
                                                    <input type="checkbox" name="sub_categories"
                                                           value={{subcategory.id}} subcategoryid={{subcategory.id}}
                                                           {% if userInterest|one_more:subcategory.id|isSubCategoryChecked:types.id%}
                                                           checked
                                                           {% endif %}>
                                                    <label class="interestLabel" style="font-size: 12px;"
                                                           for={{subcategory.name}}>{{subcategory.name}}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            {% endif %}
                                        </div>

                                    </li>
                                    {% endfor %}
                                </ul>
                                {% endif %}
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    <button type="submit" class="btn btn-success" onclick="interestSubmit(event)"
                            style="width:100%;margin: 10px 0px;">Submit
                    </button>
                </form>
            </div>
                {% endif %}
            <div class="footer-menu">
                <a href="{% url 'blog:articles_list' %}">Blog | </a>
                <a href="{% url 'about' %}">About | </a>
                <a href="{% url 'terms' %}">Terms | </a>
                <a href="{% url 'privacy_policy' %}">Privacy Policy | </a>
                <a href="{% url 'user_feedback' %}">Feedback |</a>
                <a href="{% url 'help' %}">Help</a>
                <p>Â© 2020 Omokaa, Inc.</p>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block domready %}
<script>
    var searchInput = 'id_location';
    $(document).ready(function () {

        $(".shareBtn").click(function () {
            $("#shareH1").hide();
            if ($(window).width() >= 556) {
                $("#menu-md").show();
            }
            $("#shareHeader").show();
            $("#shareDetails").show();
        });

        $(".closeBtn").click(function () {
            $("#shareH1").show();
            $("#menu-table").show();
            $("#shareHeader").hide();
            $("#shareDetails").hide();
            $("#menu-md").hide();
            document.getElementById('postFormSpinner').style.display = 'none'
        });

        $(".shareBtn-sm").click(function () {
            var is_authenticated = "{{request.user.is_authenticated}}";
            if(is_authenticated == 'False'){
                return
            }
            $("#shareH1").hide();
            $("#menu-table").hide();
            $("#menu-md").show();
            $("#shareHeader").show();
            $("#shareDetails").show();
        });

        

        //0ld js

        $("#sharePost").click(function () {
            $("#postForm").css("display", "block");
            $("#postShare").css("display", "none");
        });

        $("#noInterests").click(function () {
            $("#noInterests").css("display", "none")
            $("#selInterests").css("display", "block")
        });

        $("#changeInterests").click(function () {
            $("#interestForm").show()
            $("#changeInterests").hide()
        });

        loadPost()
        if ($(window).width() >= 975) {
            loadUserInterest()
        }

        $("#submit").attr('disabled', 'disabled');

        $("#id_category").change(function () {
            var url = $("#postForm").attr("data-category-url");  // get the url of the `load_cities` view
            var sub_categoryId = $(this).val();  // get the selected country ID from the HTML input

            $.ajax({                       // initialize an AJAX request
                url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                data: {
                    'category': sub_categoryId       // add the country id to the GET parameters
                },
                success: function (data) {   // `data` is the return of the `load_cities` view function
                    $("#id_sub_category").html(data);  // replace the contents of the city input with the data that came from the server
                }
            });

        });

        $("#id_sub_category").change(function () {

            $("#submit").removeAttr('disabled');

        });

        $(".textarea").on("keyup input", function () {
            $(this).css('height', 'auto').css('height', this.scrollHeight + (this.offsetHeight - this.clientHeight));
        });


        $("#unauth_type").change(function () {
            var url = $("#resultForm").attr("data-category-url");   // get the url of the `load_cities` view
            var typeId = $(this).val();  // get the selected country ID from the HTML input

            $.ajax({                       // initialize an AJAX request
                url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                data: {
                    'type': typeId       // add the country id to the GET parameters
                },
                success: function (data) {   // `data` is the return of the `load_cities` view function
                    $("#unauth_category").html(data);  // replace the contents of the city input with the data that came from the server
                }
            });
        });

        $("#unauth_category").change(function () {
            var url = $("#resultForm").attr("data-category-url");  // get the url of the `load_cities` view
            var sub_categoryId = $(this).val();  // get the selected country ID from the HTML input
            $.ajax({                       // initialize an AJAX request
                url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                data: {
                    'category': sub_categoryId       // add the country id to the GET parameters
                },
                success: function (data) {   // `data` is the return of the `load_cities` view function
                    $("#unauth_sub_category").html(data);  // replace the contents of the city input with the data that came from the server
                   
                }
            });
            
        });

        $('#unauth_sub_category').change(function () {
           
        });

        var autocomplete;
        autocomplete = new google.maps.places.Autocomplete((document.getElementById(searchInput)), {
            types: ['geocode'],
        });


        google.maps.event.addListener(autocomplete, 'place_changed', function () {
            var near_place = autocomplete.getPlace();
        });


        $("#submit3").click(function () {
            $("#promote").css("display", "block");
            $("#postForm").css("display", "none");
            $("#postShare").css("display", "none");
        });
    });

    


    function openAuthorFeedback(event){
        event.preventDefault()
        var ratingid = event.target.attributes.ratingid.value
        var feedbackform = document.getElementById(ratingid + 'authorfeedback')
        feedbackform.style.display = 'initial'
    }

    function authorFeedbackSubmit(event){
        event.preventDefault()
        var kvpairs = {'feedback':''};
        var form = event.target // get the form somehow
        var ratingid = form.attributes.ratingid.value
        var postid = form.attributes.postid.value
        var url = form.attributes.feedbackurl.value
        var updateurl = form.attributes.feedbackUpdate.value
        for ( var i = 0; i < form.elements.length; i++ ) {
            var e = form.elements[i];
            if (e.checked || e.name == 'feedback') {
                kvpairs[e.name] = e.value;
            }
        }
        console.log(kvpairs)
        $.ajax({
            url:url,
            type:'POST',
            data:{
                ratingid:ratingid,
                feedback:kvpairs['feedback'],
                csrfmiddlewaretoken:'{{csrf_token}}'
            },
            success:function(){
                $.ajax({
                    url:updateurl,
                    data:{
                        'postId':postid
                    },
                    success:function(data){
                        document.getElementById(`${postid}feedbackList`).innerHTML = data
                    }
                })
            }
        })
    }



    function submitFilter(event){
        event.preventDefault()
        reLoadUnAuthPost()
    }

    function selectType(event){
            var className = 'selectedType'
            var typeid = event.target.attributes.typeid.value
            var tags = document.getElementsByClassName(className)
            Object.values(tags).map(item => item.classList.remove(className))
            document.getElementById(typeid+'formtype').classList.add(className)

            var url = $("#postForm").attr("data-category-url");  
            $.ajax({                       // initialize an AJAX request
                url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                data: {
                    'type': typeid       // add the country id to the GET parameters
                },
                success: function (data) {   // `data` is the return of the `load_cities` view function
                    document.getElementById('id_type').value = typeid
                    $("#id_category").html(data);  // replace the contents of the city input with the data that came from the server
                    $('#id_sub_category')[0].innerHTML = ''
                    $("#submit").attr('disabled', 'disabled');
                    document.getElementById('id_thumbnail').value = ''
                    document.getElementById('id_detail').value = ''
                    document.getElementById('id_location').value = ''
                    document.getElementById('postBtn').style.display = 'inherit'
                    document.getElementById('promote').style.display = 'none'
                    document.getElementById('promotePay').style.display = 'none'
                    try{
                        document.getElementById('imgList').innerHTML = ''
                    }catch(err){
 
                    }
                }
            });
    }



    function openDetailPage(event){
        event.preventDefault()
        window.location = window.location.origin + event.target.attributes.href.value
    }


    function submitBio(event) {
        event.preventDefault()
        var bio = document.getElementById('bioinput').value
        var url = event.target.attributes.biourl.value
        $.ajax({
            url: url,
            type: 'POST',
            data: {
                'bio': bio,
                'csrfmiddlewaretoken': '{{csrf_token}}'
            },
            success: function (data) {
                document.getElementById('bioSection').style.display = 'none'
                document.getElementById('bioAlert').style.display = 'block'
            }
        })
    }


    function submitPost(event) {
        event.preventDefault()
        document.getElementById('postFormSpinner').style.display = 'inherit'
        document.getElementById('closebutton').style.display = 'none'   
        var url = $('#postForm').attr('formURL')
        var description = document.getElementById('id_detail').value
        var location = document.getElementById('id_location').value
        if (description == '') {
            alert("description can't be leave empty")
            return
        } else if (location == '') {
            alert("Location can't be leave empty")
            return
        }

        var postType = document.getElementById('id_type').value
        var category = document.getElementById('id_category').value
        var sub_category = document.getElementById('id_sub_category').value
        var thumbnail = document.getElementById('id_thumbnail').files
        var formdata = new FormData()

        formdata.append("csrfmiddlewaretoken", '{{ csrf_token }}')
        formdata.append("detail", description)
        formdata.append("location", location)
        formdata.append("type", postType)
        formdata.append("category", category)
        formdata.append("sub_category", sub_category)
        var totalfiles = document.getElementById('id_thumbnail').files.length;
   for (var index = 0; index < totalfiles; index++) {
      formdata.append("thumbnail", document.getElementById('id_thumbnail').files[index]);
      formdata.append("length", document.getElementById('id_thumbnail').files.length);
   }
        $.ajax({
            url: url,
            type: 'POST',
            enctype: 'multipart/form-data',
            data: formdata,
            contentType: false,
            processData: false,
            cache: false,
            success: function (data) {
                document.getElementById('closebutton').style.display = 'initial'
                $(".closeBtn").click()
                loadPostWithoutSpinner()
                document.getElementById('id_type').value = ''
                document.getElementById('id_category').value = ''
                document.getElementById('id_sub_category').value = ''
            },
            error: function (err) {
                alert(err)
            }
        })
    }

    function displayPromotion(event) {
        event.preventDefault()
        document.getElementById('promotePay').style.display = 'block'
        document.getElementById('promote').style.display = 'none'
    }
    
    function hidePromotional(event){
        event.preventDefault()
        document.getElementById('promotePay').style.display = 'none'
        document.getElementById('promote').style.display = 'inherit'
    }

    function submitPromotionalPost(event) {
        event.preventDefault()
        package_type = $("input[name=package_type]:checked").val()
        var url = $('#postForm').attr('promotionalFormURL')
        var description = document.getElementById('id_detail').value
        var location = document.getElementById('id_location').value
        if (description == '') {
            alert("description can't be leave empty")
            return
        } else if (location == '') {
            alert("Location can't be leave empty")
            return
        }
        var postType = document.getElementById('id_type').value
        var category = document.getElementById('id_category').value
        var sub_category = document.getElementById('id_sub_category').value
        var thumbnail = document.getElementById('id_thumbnail').files[0]
        var formdata = new FormData()

        formdata.append("csrfmiddlewaretoken", '{{ csrf_token }}')
        formdata.append("detail", description)
        formdata.append("location", location)
        formdata.append("type", postType)
        formdata.append("category", category)
        formdata.append("sub_category", sub_category)
        formdata.append("package_type", package_type)
        if (thumbnail) {
            formdata.append("thumbnail", thumbnail)
        }
        $.ajax({
            url: url,
            type: 'POST',
            data: formdata,
            contentType: false,
            processData: false,
            success: function (data) {
                loadPostWithoutSpinner()
                $(".closeBtn").click()
                document.getElementById('id_type').value = ''
                document.getElementById('id_category').value = ''
                document.getElementById('id_sub_category').value = ''
            },
            error: function (err) {
                console.log(err)
            }
        })
    }


    function displayPostTypes(event) {
        event.preventDefault()
        var description = document.getElementById('id_detail').value
        var location = document.getElementById('id_location').value
        if (description == '') {
            alert("description can't be leave empty")
            return
        } else if (location == '') {
            alert("Location can't be leave empty")
            return
        }
        document.getElementById('promote').style.display = 'inherit'
        document.getElementById('postBtn').style.display = 'none'
    }

    function loadUserInterest() {
        var url = $('#selectedInterest').attr('interestUrl')
        $.ajax({
            url: url,
            success: function (data) {
                try{
                document.getElementById('selectedInterest').innerHTML = data
                }
                catch(err){
                    console.log(err)
                }
            },
            error: function (err) {
                console.log(err)
            }
        })
    }

    function loadPost() {
        var url = $("#postDisplay").attr('postURL')
        var disableButton = document.getElementById('disabledPostButton')
        $.ajax({
            url: url,
            success: function (data) {
                document.getElementById("postDisplay").innerHTML = data
                disableButton ? disableButton.style.display = 'none' : ''
                var infinite = new Waypoint.Infinite({
                    element: $('.infinite-container')[0],
                    onBeforePageLoad: function () {
                    $('.loading').show();
                },
                onAfterPageLoad: function ($items) {
                    $('.loading').hide();
                }
                });
            }
        })
    }


    function reLoadUnAuthPost(myParam = '') {
        var url = $('#resultForm').attr('data-result-url')
        var type = $("#unauth_type").val()
        var category = $("#unauth_category").val()
        var sub_category = $("#unauth_sub_category").val()
        var location = $("#unauth_location").val()
        $.ajax({
            url: url,
            data: {
                q: myParam,
                type: type,
                category: category,
                sub_category: sub_category,
                location: location
            },
            success: function (data) {
                document.getElementById('postDisplay').innerHTML = data
                document.getElementById('filterSection').style.display= 'block'
                var infinite = new Waypoint.Infinite({
                    element: $('.infinite-container')[0],
                    onBeforePageLoad: function () {
                    $('.loading').show();
                },
                onAfterPageLoad: function ($items) {
                    $('.loading').hide();
                }
                });

            },
            error: function (msg) {
                console.log(msg)
            }
        })
    }

    function loadPostWithoutSpinner() {
        var url = $("#postDisplay").attr('postURL')
        $.ajax({
            url: url,
            success: function (data) {
                document.getElementById("postDisplay").innerHTML = data
                var infinite = new Waypoint.Infinite({
                    element: $('.infinite-container')[0],
                    onBeforePageLoad: function () {
                    $('.loading').show();
                },
                onAfterPageLoad: function ($items) {
                    $('.loading').hide();
                }
                });
            }
        })
    }


    function openInterestForm(event) {
        $("#noInterests").css("display", "none")
        $("#selInterests").css("display", "block")
    }

    function openOffer(event,offertype){
        event.preventDefault()
        var postid = event.target.attributes.postid.value
        document.getElementById(postid + 'feedbackdiv').style.display = 'none'
        var offerdiv = document.getElementById(postid + 'offerdiv')
        offerdiv.setAttribute('offer_type',offertype)
        offerdiv.style.display = 'initial'
        
    }

    function openOfferUpdate(event,offer_type){
        event.preventDefault()
        var postid = event.target.attributes.postid.value
        document.getElementById(postid + 'feedbackdiv').style.display = 'none'
        var offerdiv = document.getElementById(postid + 'offerdiv')
        offerdiv.setAttribute('offer_type',offer_type)
        offerdiv.style.display = 'initial'

        var url = document.getElementById(postid + 'offerdiv').attributes.offerUpdate.value
        $.ajax({
            url:url,
            data:{
                postid:postid,
                offertype:offer_type
            },
            success:function(data){
                document.getElementById(postid + 'offerdiv').innerHTML = data
                try{    
                    if(document.getElementById(postid+'offer').value !== ''){
                    document.getElementById(postid+'offerEditIcon').style.display = 'initial'
                    }
                }catch(err){}
            },
            error:function(err){
                console.log(err)
            }
        })
    }

    function openOfferFeedback(event){
        event.preventDefault()
        var proposalid = event.target.attributes.proposalid.value
        document.getElementById(proposalid+'offerfeedback').style.display = 'initial'
    }


    function openfeedback(event) {
        event.preventDefault()
        var postid = event.target.attributes.postid.value
        document.getElementById(postid + 'offerdiv').style.display = 'none'
        document.getElementById(postid + 'feedbackdiv').style.display = 'initial'
    }

    function openUpdateFeedback(event){
        event.preventDefault()
        var url = event.target.attributes.feedbackfetchurl.value
        var postid = event.target.attributes.postid.value
        document.getElementById(postid + 'offerdiv').style.display = 'none'
        document.getElementById(postid+'reviewEditIcon').style.display = 'initial'
        var feedbackdiv = document.getElementById(postid + 'feedbackdiv')
        $.ajax({
            url:url,
            data:{
                postid:postid
            },
            success:function(data){
                var {rating,feedback} = data
                document.getElementById(`post${postid}${rating}`).checked = 'checked'
                document.getElementById(`${postid}starfeedback`).value = decodeURI(feedback)
                feedbackdiv.style.display = 'initial'
            },
            error:function(err){
                alert('Network Issue')
            }
        })
    }

    function offerSubmit(event){
        event.preventDefault()
        var form = event.target
        console.log(form)
        var kvpairs = {offer: ''};
        var postid = form.attributes.postid.value
        var url = form.attributes.offerurl.value
        var updateurl = form.attributes.offerUpdate.value
        var offertype = document.getElementById(postid + 'offerdiv').attributes.offer_type.value
        for (var i = 0; i < form.elements.length; i++) {
            var e = form.elements[i];
            if (e.name == 'offer') {
                kvpairs[e.name] = e.value;
            }
        }
        $.ajax({
            url:url,
            type: 'POST',
            data:{
                postid: postid,
                offer : kvpairs['offer'],
                offertype: offertype,
                csrfmiddlewaretoken: '{{csrf_token}}'
            },
            success:function(data){
                document.getElementById(postid + 'offerdiv').style.display = 'none'
            },
            error:function(err){
                console.log(err)
            }
        })
    }


    function offerFeedbackSubmit(event){
        event.preventDefault()
        var kvpairs = {'feedback':''}
        var form = event.target
        var proposaltype = form.attributes.proposaltype.value
        var proposalid = form.attributes.proposalid.value
        var posid = form.attributes.postid.value
        var url = form.attributes.feedbackurl.value
        for (var i = 0; i < form.elements.length; i++) {
            var e = form.elements[i];
            if (e.checked || e.name == 'feedback') {
                kvpairs[e.name] = e.value;
            }
        }
        $.ajax({
            url:url,
            type:'POST',
            data: {
                proposalid: proposalid,
                proposaltype: proposaltype,
                feedback: kvpairs['feedback'],
                csrfmiddlewaretoken: '{{csrf_token}}'
            },
            success: function (data) {
                document.getElementById(posid+'offerdiv').innerHTML = data
            }
        })

    }

    function feedbackSubmit(event) {
        event.preventDefault()
        var kvpairs = {'rating': '', 'feedback': ''};
        var form = event.target // get the form somehow
        var postid = form.attributes.postid.value
        var url = form.attributes.feedbackurl.value
        var updateurl = form.attributes.feedbackUpdate.value
        for (var i = 0; i < form.elements.length; i++) {
            var e = form.elements[i];
            if (e.checked || e.name == 'feedback') {
                kvpairs[e.name] = e.value;
            }
        }
        $.ajax({
            url: url,
            type: 'POST',
            data: {
                postid: postid,
                rating: kvpairs['rating'],
                feedback: kvpairs['feedback'],
                csrfmiddlewaretoken: '{{csrf_token}}'
            }, 
            success: function (data) {
                document.getElementById(`${postid}feedbackdiv`).style.display = 'none';
                document.getElementById(`${postid}rating`).firstChild.data = data['rating'];
                document.getElementById(`${postid}rating_count`).firstChild.data = ` ${data['rating_count']} Reviews`;
            }
        })
    }


    function interestSubmit(event) {
        event.preventDefault()
        reloadPost()
    }


    function loadStartCategories() {
        // console.log(event.target)
    }

    function loadCategories(event) {
        var typeid = event.target.attributes.typeid.value
        var tagId = typeid + "loadCategories"
        if (event.target.checked) {
            var url = $("#interestTag").attr('categoryURL')
            $.ajax({
                url: url,
                data: {
                    typeid: typeid
                },
                success: function (data) {
                    document.getElementById(tagId).innerHTML = data
                }
            })
        } else {
            document.getElementById(tagId).innerHTML = ''
        }
    }

    function loadSubCategories(event) {
        var categoryid = event.target.attributes.categoryid.value
        var typeid = event.target.attributes.typeid.value
        var tagId = typeid + categoryid + "loadSubCategories"
        if (event.target.checked) {
            var url = $("#interestTag").attr('subCategoryURL')
            $.ajax({
                url: url,
                data: {
                    categoryid: categoryid
                },
                success: function (data) {
                    document.getElementById(tagId).innerHTML = data
                }
            })
        } else {
            document.getElementById(tagId).innerHTML = ''
        }
    }

</script>

<script>

    // Image Loading

    // Check if a element is in view
    function isInViewport(el) {
    const rect = el.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)

    );
    }
</script>

<script>
    //I added event handler for the file upload control to access the files properties.
    document.addEventListener("DOMContentLoaded", init, false);

    //To save an array of attachments
    var AttachmentArray = [];

    //counter for attachment array
    var arrCounter = 0;

    //to make sure the error message for number of files will be shown only one time.
    var filesCounterAlertStatus = false;

    //un ordered list to keep attachments thumbnails
    var ul = document.createElement("ul");
    ul.className = "thumb-Images";
    ul.id = "imgList";

    function init() {
        //add javascript handlers for the file upload event
        document
            .querySelector("#id_thumbnail")
            .addEventListener("change", handleFileSelect, false);
    }


    function likePost(event) {
        event.preventDefault()
        var target = event.target.children[0]
        var postid = target.attributes.postid.value
        var url = document.getElementById('urlTag').attributes.likedislikeurl.value
        var currentColor = target.attributes.fill.value
        target.attributes.fill.value = currentColor === 'blue' ? 'currentColor' : 'blue';
        document.getElementById(postid + 'dislike').attributes.fill.value = 'currentColor'
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                postId: postid,
                action: 'like',
                csrfmiddlewaretoken: '{{csrf_token}}'
            },
            success: function (data) {
                console.log(data)
                document.getElementById(postid + 'likeCount').innerHTML = data.likes
                document.getElementById(postid + 'dislikeCount').innerHTML = data.dislikes
            },
            error: function (err) {
                console.log(err)
                var currentColor = target.attributes.fill.value
                target.attributes.fill.value = currentColor === 'blue' ? 'currentColor' : 'blue';
            }
        })
    }


    function dislikePost(event) {
        event.preventDefault()
        var target = event.target.children[0]
        var postid = target.attributes.postid.value
        var url = document.getElementById('urlTag').attributes.likedislikeurl.value
        var currentColor = target.attributes.fill.value
        target.attributes.fill.value = currentColor === 'red' ? 'currentColor' : 'red'
        document.getElementById(postid + 'like').attributes.fill.value = 'currentColor'
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                postId: postid,
                action: 'dislike',
                csrfmiddlewaretoken: '{{csrf_token}}'
            },
            success: function (data) {
                console.log(data)
                document.getElementById(postid + 'likeCount').innerHTML = data.likes
                document.getElementById(postid + 'dislikeCount').innerHTML = data.dislikes
            },
            error: function (err) {
                console.log(err);
                var currentColor = target.attributes.fill.value
                target.attributes.fill.value = currentColor === 'red' ? 'currentColor' : 'red';
            }
        })
    }

    function closesubmit(event) {
        event.target.parentElement.parentElement.style.display = 'none'
    }

    const copyToClipboard = str => {
        const el = document.createElement('textarea');
        el.value = str;
        el.setAttribute('readonly', '');
        el.style.position = 'absolute';
        el.style.left = '-9999px';
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
    };


    const copyUrl = event => {
        var str = window.location.origin + event.target.attributes.postURL.value
        copyToClipboard(str)
    }

    const openDeletePopUp = event => {
        event.preventDefault()
        var postid = event.target.attributes.postid.value
        document.getElementById('confirmDeleteBtn').setAttribute('postid', postid)
        document.getElementById('deleteBtn').click()
    }

    const openReportPopUp = event => {
        event.preventDefault()
        var postid = event.target.attributes.postid.value
        document.getElementById('confirmFraudBtn').setAttribute('postid', postid)
        document.getElementById('confirmSpamBtn').setAttribute('postid', postid)
        document.getElementById('reportBtn').click()
    }

    const deletePost = event => {
        var postid = event.target.attributes.postid.value
        var url = event.target.attributes.deleteurl.value
        $.ajax({
            url: url,
            data: {
                postid: postid
            },
            success: function (data) {
                console.log(data)
                loadPost()
            },
            error: function (msg) {
                console.log(msg)
            }
        })

    }

    const fraudPost = event => {
        var postid = event.target.attributes.postid.value
        var url = event.target.attributes.reporturl.value
        $.ajax({
            url: url,
            data: {
                postid: postid,
                report_type: 'FRAUD'
            },
            success: function (data) {
                console.log(data)
                document.getElementById('reportAlert').style.display = 'inherit'
            },
            error: function (msg) {
                console.log(msg)
            }
        })
    }

    const spamPost = event => {
        var postid = event.target.attributes.postid.value
        var url = event.target.attributes.reporturl.value
        $.ajax({
            url: url,
            data: {
                postid: postid,
                report_type: 'SPAM'
            },
            success: function (data) {
                console.log(data)
                document.getElementById('reportAlert').style.display = 'inherit'
            },
            error: function (msg) {
                console.log(msg)
            }
        })
    }

    const removeOverflow = event => {

    }


    //the handler for file upload event
    function handleFileSelect(e) {
        //to make sure the user select file/files
        if (!e.target.files) return;

        //To obtaine a File reference
        var files = e.target.files;
        // Loop through the FileList and then to render image files as thumbnails.
        for (var i = 0, f; (f = files[i]); i++) {
            console.log(files)
            var flag = true
            //instantiate a FileReader object to read its contents into memory
            var fileReader = new FileReader();
            // Closure to capture the file information and apply validation.
            fileReader.onload = (function (readerEvt) {
                return function (e) {
                    //Apply the validation rules for attachments upload

                    var is_file_valid = ApplyFileValidationRules(readerEvt);
                    if(!is_file_valid){
                        console.log('inside')
                        document.getElementById('id_thumbnail').value = ''
                        flag = false
                    }
                    else{
                        //Render attachments thumbnails.
                    RenderThumbnail(e, readerEvt);

                    //Fill the array of attachment
                    FillAttachmentArray(e, readerEvt);
                    } 
                };
            })(f);
            // Read in the image file as a data URL.
            // readAsDataURL: The result property will contain the file/blob's data encoded as a data URL.
            // More info about Data URI scheme https://en.wikipedia.org/wiki/Data_URI_scheme
            fileReader.readAsDataURL(f);
        }
        document
            .getElementById("id_thumbnail")
            .addEventListener("change", handleFileSelect, false);
    }

    //To remove attachment once user click on x button
    jQuery(function ($) {
        $("div").on("click", ".img-wrap .close", function () {
            var id = $(this)
                .closest(".img-wrap")
                .find("img")
                .data("id");

            //to remove the deleted item from array
            var elementPos = AttachmentArray.map(function (x) {
                return x.FileName;
            }).indexOf(id);
            if (elementPos !== -1) {
                AttachmentArray.splice(elementPos, 1);
            }

            //to remove image tag
            $(this)
                .parent()
                .find("img")
                .not()
                .remove();

            //to remove div tag that contain the image
            $(this)
                .parent()
                .find("div")
                .not()
                .remove();

            //to remove div tag that contain caption name
            $(this)
                .parent()
                .parent()
                .find("div")
                .not()
                .remove();

            //to remove li tag
            var lis = document.querySelectorAll("#imgList li");
            for (var i = 0; (li = lis[i]); i++) {
                if (li.innerHTML == "") {
                    li.parentNode.removeChild(li);
                }
            }
        });
    });

    //Apply the validation rules for attachments upload
    function ApplyFileValidationRules(readerEvt) {
        //To check file type according to upload conditions
        if (CheckFileType(readerEvt.type) == false) {
            alert(
                "The file (" +
                readerEvt.name +
                ") does not match the upload conditions, You can only upload jpg/png/gif files"
            );
            return false;
        }

        //To check file Size according to upload conditions
        if (CheckFileSize(readerEvt.size) == false) {
            alert(
                "The file (" +
                readerEvt.name +
                ") does not match the upload conditions, The maximum file size for uploads should not exceed 5MB"
            );
            return false;
        }

        //To check files count according to upload conditions
        if (CheckFilesCount(AttachmentArray) == false) {
            if (!filesCounterAlertStatus) {
                filesCounterAlertStatus = true;
                alert(
                    "You have added more than 10 files. According to upload conditions you can upload 10 files maximum"
                );
            }
            return false;
        }
        return true
    }

    //To check file type according to upload conditions
    function CheckFileType(fileType) {
        console.log(fileType)
        if (fileType == "image/jpeg") {
            return true;
        } else if (fileType == "image/png") {
            return true;
        } else if (fileType == "image/gif") {
            return true;
        } else {
            return false;
        }
        return true;
    }

    //To check file Size according to upload conditions
    function CheckFileSize(fileSize) {
        if (fileSize < 5000000) {
            return true;
        } else {
            return false;
        }
        return true;
    }

    //To check files count according to upload conditions
    function CheckFilesCount(AttachmentArray) {
        //Since AttachmentArray.length return the next available index in the array,
        //I have used the loop to get the real length
        var len = 0;
        for (var i = 0; i < AttachmentArray.length; i++) {
            if (AttachmentArray[i] !== undefined) {
                len++;
            }
        }
        //To check the length does not exceed 10 files maximum
        if (len > 9) {
            return false;
        } else {
            return true;
        }
    }

    //Render attachments thumbnails.
    function RenderThumbnail(e, readerEvt) {
        var li = document.createElement("li");
        ul.appendChild(li);
        li.innerHTML = [
            '<div class="img-wrap"> <span class="close">&times;</span>' +
            '<img class="thumb" src="',
            e.target.result,
            '" title="',
            escape(readerEvt.name),
            '" data-id="',
            readerEvt.name,
            '"/>' + "</div>"
        ].join("");

        var div = document.createElement("div");
        div.className = "FileNameCaptionStyle";
        li.appendChild(div);
        div.innerHTML = [readerEvt.name].join("");
        document.getElementById("Filelist").insertBefore(ul, null);
    }

    //Fill the array of attachment
    function FillAttachmentArray(e, readerEvt) {
        AttachmentArray[arrCounter] = {
            AttachmentType: 1,
            ObjectType: 1,
            FileName: readerEvt.name,
            FileDescription: "Attachment",
            NoteText: "",
            MimeType: readerEvt.type,
            Content: e.target.result.split("base64,")[1],
            FileSizeInBytes: readerEvt.size
        };
        arrCounter = arrCounter + 1;
    }


</script>
{% endblock %}